# 🚀 腾讯云云开发开通和部署指南

## 📋 开通步骤

### 1. 开通云开发服务
1. 访问 [腾讯云云开发控制台](https://console.cloud.tencent.com/tcb)
2. 点击"立即开通"
3. 选择"按量计费"或"资源包"（推荐新手选择资源包）
4. 完成实名认证和支付

### 2. 创建环境
1. 在控制台点击"新建环境"
2. 环境名称：`love-website-env`
3. 环境ID：系统自动生成（如：`cloud1-9ghdf1i93f8fb2b9`）
4. 选择地域：建议选择离你最近的地区
5. 点击"确定"创建

### 3. 开通数据库服务
1. 在环境列表中选择刚创建的环境
2. 点击"数据库"标签页
3. 点击"开通数据库"
4. 选择"云数据库"
5. 设置数据库名称：`love_website_db`
6. 选择"按量计费"
7. 点击"确定"开通

### 4. 开通云函数服务
1. 在环境列表中选择环境
2. 点击"云函数"标签页
3. 点击"开通云函数"
4. 选择"按量计费"
5. 点击"确定"开通

### 5. 开通云存储服务
1. 在环境列表中选择环境
2. 点击"云存储"标签页
3. 点击"开通云存储"
4. 选择"按量计费"
5. 点击"确定"开通

## 🗄️ 创建数据库集合

### 1. 创建 love_feed 集合
1. 进入"数据库"页面
2. 点击"新建集合"
3. 集合名称：`love_feed`
4. 权限设置：选择"所有用户可读，仅创建者可写"
5. 点击"确定"

### 2. 创建 interactions 集合
1. 点击"新建集合"
2. 集合名称：`interactions`
3. 权限设置：选择"仅创建者可读写"
4. 点击"确定"

### 3. 创建 memories 集合
1. 点击"新建集合"
2. 集合名称：`memories`
3. 权限设置：选择"所有用户可读，仅创建者可写"
4. 点击"确定"

### 4. 创建 users 集合
1. 点击"新建集合"
2. 集合名称：`users`
3. 权限设置：选择"仅创建者可读写"
4. 点击"确定"

## ⚡ 部署云函数

### 1. 安装云开发CLI工具
```bash
npm install -g @cloudbase/cli
```

### 2. 登录腾讯云
```bash
tcb login
```

### 3. 进入云函数目录
```bash
cd cloud-functions
```

### 4. 部署所有云函数
```bash
tcb fn deploy
```

### 5. 单独部署某个云函数
```bash
tcb fn deploy getLuckyNote
tcb fn deploy getLoveQuiz
tcb fn deploy addMemory
tcb fn deploy getMemories
```

## 🔧 配置前端

### 1. 更新环境ID
在 `index.html` 中找到 `CLOUDBASE_CONFIG` 对象，将 `env` 字段更新为你的实际环境ID：

```javascript
const CLOUDBASE_CONFIG = {
    env: '你的环境ID', // 例如：cloud1-9ghdf1i93f8fb2b9
    // ... 其他配置
};
```

### 2. 引入云开发核心文件
确保在 `index.html` 中引入了 `cloudbase-core.js` 文件：

```html
<script src="cloudbase-core.js"></script>
```

## 📱 测试功能

### 1. 测试幸运签
1. 打开网页
2. 点击"获取幸运签"按钮
3. 查看控制台是否有错误信息
4. 检查数据库是否记录了互动数据

### 2. 测试爱情问答
1. 点击"获取爱情问答"按钮
2. 查看是否返回问题数据
3. 检查数据库记录

### 3. 测试添加回忆
1. 使用 `cloudBaseManager.addMemory()` 函数
2. 检查数据库是否成功添加数据

## 🚨 常见问题

### 1. 环境状态异常
- 等待几分钟后重试
- 检查账户余额是否充足
- 联系腾讯云客服

### 2. 云函数调用失败
- 检查环境ID是否正确
- 确认云函数是否部署成功
- 查看云函数日志

### 3. 数据库连接失败
- 确认数据库服务是否开通
- 检查集合权限设置
- 验证环境ID配置

### 4. 权限不足
- 检查集合的权限设置
- 确认用户身份验证
- 查看安全规则配置

## 💰 费用说明

### 免费额度（每月）
- 数据库：1GB存储，100万次读操作，10万次写操作
- 云函数：100万次调用，40万GBs计算资源
- 云存储：5GB存储，100GB下载流量

### 超出免费额度
- 数据库：按实际使用量计费
- 云函数：按调用次数和计算时间计费
- 云存储：按存储量和下载流量计费

## 📞 技术支持

- 腾讯云官方文档：[云开发文档](https://cloud.tencent.com/document/product/876)
- 社区论坛：[开发者社区](https://cloud.tencent.com/developer)
- 技术支持：[工单系统](https://console.cloud.tencent.com/workorder)

---

**注意：** 请妥善保管你的环境ID和密钥信息，不要泄露给他人！
