/**
 * 腾讯云SDK模拟器
 * 由于网络问题无法下载官方SDK，提供基本API接口
 */

(function(global) {
    'use strict';
    
    // 模拟腾讯云SDK命名空间
    var TencentCloud = {
        // 人脸识别服务
        iai: {
            v20200303: {
                Client: function(config) {
                    this.config = config;
                    this.credential = config.credential;
                    this.region = config.region;
                    this.profile = config.profile;
                    
                    // 人脸检测
                    this.DetectFace = function(params) {
                        return new Promise(function(resolve, reject) {
                            // 模拟API调用延迟
                            setTimeout(function() {
                                try {
                                    // 模拟检测结果
                                    var result = {
                                        Response: {
                                            RequestId: 'mock_' + Date.now(),
                                            FaceNum: 1,
                                            FaceInfos: [{
                                                FaceId: 'face_' + Math.random().toString(36).substr(2, 9),
                                                FaceRect: {
                                                    X: 100,
                                                    Y: 100,
                                                    Width: 200,
                                                    Height: 200
                                                },
                                                FaceAttributes: {
                                                    Age: 25,
                                                    Gender: 1,
                                                    Expression: 1,
                                                    Glass: 0,
                                                    Hat: 0,
                                                    Mask: 0
                                                },
                                                FaceQualityInfo: {
                                                    Score: 95,
                                                    Sharpness: 90,
                                                    Brightness: 85,
                                                    Completeness: 95
                                                }
                                            }]
                                        }
                                    };
                                    resolve(result);
                                } catch (error) {
                                    reject(error);
                                }
                            }, 300);
                        });
                    };
                    
                    // 人脸比对
                    this.CompareFace = function(params) {
                        return new Promise(function(resolve, reject) {
                            setTimeout(function() {
                                try {
                                    // 模拟比对结果
                                    var similarity = Math.random() * 0.3 + 0.7; // 70%-100%
                                    var score = Math.floor(similarity * 100);
                                    
                                    var result = {
                                        Response: {
                                            RequestId: 'mock_' + Date.now(),
                                            Score: score,
                                            FaceModelVersion: '3.0'
                                        }
                                    };
                                    resolve(result);
                                } catch (error) {
                                    reject(error);
                                }
                            }, 500);
                        });
                    };
                    
                    // 人脸搜索
                    this.SearchFaces = function(params) {
                        return new Promise(function(resolve, reject) {
                            setTimeout(function() {
                                try {
                                    var result = {
                                        Response: {
                                            RequestId: 'mock_' + Date.now(),
                                            FaceNum: 1,
                                            FaceInfos: [{
                                                FaceId: 'face_' + Math.random().toString(36).substr(2, 9),
                                                Score: Math.floor(Math.random() * 30 + 70)
                                            }]
                                        }
                                    };
                                    resolve(result);
                                } catch (error) {
                                    reject(error);
                                }
                            }, 400);
                        });
                    };
                    
                    // 创建人员
                    this.CreatePerson = function(params) {
                        return new Promise(function(resolve, reject) {
                            setTimeout(function() {
                                try {
                                    var result = {
                                        Response: {
                                            RequestId: 'mock_' + Date.now(),
                                            PersonId: params.PersonId || 'person_' + Date.now(),
                                            FaceId: 'face_' + Math.random().toString(36).substr(2, 9)
                                        }
                                    };
                                    resolve(result);
                                } catch (error) {
                                    reject(error);
                                }
                            }, 600);
                        });
                    };
                    
                    // 人脸验证
                    this.VerifyFace = function(params) {
                        return new Promise(function(resolve, reject) {
                            setTimeout(function() {
                                try {
                                    var result = {
                                        Response: {
                                            RequestId: 'mock_' + Date.now(),
                                            Score: Math.floor(Math.random() * 30 + 70),
                                            IsMatch: Math.random() > 0.3
                                        }
                                    };
                                    resolve(result);
                                } catch (error) {
                                    reject(error);
                                }
                            }, 400);
                        });
                    };
                }
            }
        },
        
        // 通用配置
        version: '1.0.0-mock',
        description: '腾讯云SDK模拟器 - 提供基本API接口'
    };
    
    // 导出到全局作用域
    if (typeof module !== 'undefined' && module.exports) {
        module.exports = TencentCloud;
    } else if (typeof define === 'function' && define.amd) {
        define(function() { return TencentCloud; });
    } else {
        global.TencentCloud = TencentCloud;
    }
    
    // 兼容性处理
    if (typeof window !== 'undefined') {
        window.TencentCloud = TencentCloud;
    }
    
    // 控制台提示
    console.log('✅ 腾讯云SDK模拟器已加载');
    console.log('📝 注意：这是模拟器版本，用于开发和测试');
    console.log('🔗 如需真实API，请配置有效的腾讯云密钥');
    
})(typeof global !== 'undefined' ? global : typeof window !== 'undefined' ? window : this);
