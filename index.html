<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æˆ‘ä»¬çš„äº‘ç«¯æ‹çˆ±æ—¥è®° |å¼ xx &å–»xx</title>
    <style>
        :root {
            --primary: #ff6b9e;
            --secondary: #6bd5ff;
            --bg: #fef6f9;
            --text: #333;
            --card: white;
        }
        /* éšç§é®ç½©æ ·å¼ï¼ˆå·²ç§»é™¤åŠŸèƒ½ï¼Œä»…ä¿ç•™æ ·å¼ä»¥é˜²åç»­éœ€è¦ï¼‰ */
        .privacy-mask, .privacy-mask * {
            color: transparent !important;
            text-shadow: 0 0 8px #888, 0 0 12px #ccc;
            user-select: none !important;
            cursor: not-allowed !important;
        }
        .privacy-mask input, .privacy-mask textarea {
            background: #eee !important;
            color: transparent !important;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            line-height: 1.6;
            color: var(--text);
            background-color: var(--bg);
            margin: 0;
            padding: 0;
            background-image: radial-gradient(circle at 10% 20%, rgba(255, 200, 239, 0.2) 0%, rgba(255, 255, 255, 0) 50%);
        }
        
        header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            text-align: center;
            padding: 3rem 1rem;
            position: relative;
            overflow: hidden;
        }
        
        .hearts {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            pointer-events: none;
        }
        
        .heart {
            position: absolute;
            opacity: 0;
            font-size: 1.5rem;
            animation: float 6s ease-in infinite;
        }
        
        @keyframes float {
            0% {
                transform: translateY(0) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100px) rotate(360deg);
                opacity: 0;
            }
        }
        
        h1 {
            font-size: 2.5rem;
            margin: 0;
            position: relative;
            z-index: 1;
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-top: 0.5rem;
            position: relative;
            z-index: 1;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem;
            box-sizing: border-box;
        }
        
        .memory-counter {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 2rem;
            border-radius: 10px;
            text-align: center;
            margin: 2rem 0;
            position: relative;
            overflow: hidden;
            box-sizing: border-box;
        }
        
        .counter-number {
            font-size: 3rem;
            font-weight: bold;
            margin: 0.5rem 0;
        }
        
        .counter-label {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .small {
            font-size: 0.8em;
            opacity: 0.8;
        }
        
        .timeline {
            position: relative;
            padding-left: 50px;
            margin: 3rem 0;
        }
        
        .timeline::before {
            content: '';
            position: absolute;
            left: 20px;
            top: 0;
            bottom: 0;
            width: 4px;
            background: linear-gradient(to bottom, var(--primary), var(--secondary));
            border-radius: 2px;
        }
        
        .timeline-item {
            position: relative;
            margin-bottom: 2.5rem;
        }
        
        .timeline-date {
            position: absolute;
            left: -50px;
            width: 40px;
            text-align: right;
            color: var(--primary);
            font-weight: bold;
        }
        
        .timeline-content {
            background-color: var(--card);
            border-radius: 10px;
            padding: 1.5rem;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            position: relative;
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .timeline-content:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        

        
        .timeline-content::before {
            content: '';
            position: absolute;
            left: -15px;
            top: 20px;
            width: 15px;
            height: 15px;
            border-radius: 50%;
            background-color: var(--primary);
            border: 3px solid var(--bg);
        }
        
        h2 {
            color: var(--primary);
            margin-top: 0;
            font-size: 1.5rem;
        }
        
        /* æ—¶é—´è½´æ ‡é¢˜æ ·å¼ */
        .timeline-title {
            font-size: 1.6rem;
            font-weight: 700;
            background: linear-gradient(135deg, #ff6b9e, #6bd5ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 1.2rem;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
            letter-spacing: 0.5px;
        }
        
        /* æ—¶é—´è½´å†…å®¹æ–‡å­—æ ·å¼ */
        .timeline-text {
            font-size: 1.05rem;
            line-height: 1.8;
            color: #444;
            margin-bottom: 1rem;
            text-align: justify;
            font-family: 'Microsoft YaHei', 'PingFang SC', 'Helvetica Neue', Arial, sans-serif;
        }
        
        /* æ—¶é—´è½´å¼•ç”¨æ ·å¼ */
        .timeline-quote {
            font-style: italic;
            padding: 1.2rem;
            border-left: 4px solid #ff6b9e;
            background: linear-gradient(135deg, #fff6fa 0%, #f6fff9 100%);
            margin: 1.5rem 0;
            border-radius: 0 8px 8px 0;
            font-size: 1.1rem;
            line-height: 1.7;
            color: #555;
            box-shadow: 0 2px 8px rgba(255, 107, 158, 0.1);
        }
        
        /* æ—¶é—´è½´åˆ—è¡¨æ ·å¼ */
        .timeline-list {
            margin: 1rem 0;
            padding-left: 1.5rem;
        }
        
        .timeline-list li {
            margin-bottom: 0.8rem;
            color: #555;
            line-height: 1.6;
            position: relative;
            padding-left: 0.5rem;
        }
        
        .timeline-list li::before {
            content: 'ğŸ’–';
            position: absolute;
            left: -1.2rem;
            top: 0.1rem;
            font-size: 0.9rem;
        }
        
        .media-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 1rem;
        }
        
        .media-item {
            border-radius: 8px;
            overflow: hidden;
            height: 150px;
            background-size: cover;
            background-position: center;
            position: relative;
            cursor: pointer;
            transition: transform 0.3s;
        }
        
        .media-item:hover {
            transform: scale(1.05);
        }
        
        /* å›¾ç‰‡åŠ è½½å¤±è´¥æ—¶çš„æ ·å¼ */
        .media-item.img-loading-failed {
            background-color: #f8f9fa;
            border: 2px dashed #dee2e6;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #6c757d;
            font-size: 0.9rem;
            text-align: center;
            padding: 1rem;
        }
        
        .media-item.img-loading-failed::before {
            content: 'ğŸ–¼ï¸';
            font-size: 2rem;
            margin-bottom: 0.5rem;
            display: block;
        }
        
        .quote {
            font-style: italic;
            padding: 1rem;
            border-left: 3px solid var(--primary);
            background-color: rgba(255, 107, 158, 0.1);
            margin: 1rem 0;
        }
        
        footer {
            text-align: center;
            padding: 2rem;
            color: #666;
            font-size: 0.9rem;
        }
        
        /* çºªå¿µæ—¥å¼¹çª—æ ·å¼ */
        .anniversary-popup {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 9999;
            display: flex;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.5s;
        }
        
        .anniversary-content {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            max-width: 500px;
            text-align: center;
            position: relative;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        
        .close-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        /* å®æ—¶æ—¶é’Ÿæ ·å¼ */
        .real-time-clock {
            background: rgba(255,255,255,0.2);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            display: inline-block;
            margin-top: 0.5rem;
        }
        
        /* äº’åŠ¨æŒ‰é’® */
        .interactive-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            cursor: pointer;
            margin: 0.5rem;
            transition: transform 0.3s;
        }
        
        .interactive-btn:hover {
            transform: scale(1.05);
        }
        
        @media (max-width: 900px) {
            .container {
                padding: 1.2rem;
            }
        }
        @media (max-width: 768px) {
            .container { padding: 0.5rem; }
            .memory-counter {
                padding: 1.1rem 0.5rem;
                margin: 1.1rem 0;
            }
            .timeline { padding-left: 18px; }
            .timeline-date { left: -18px; width: 18px; font-size: 0.8rem; }
            h1 { font-size: 1.3rem; }
            .counter-number { font-size: 1.2rem; }
            .media-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 6px;
            }
            .media-item {
                height: 90px;
            }
            .anniversary-content {
                padding: 1.1rem 0.5rem;
                max-width: 98vw;
            }
            #quit-smoking-modal > div {
                padding: 1.1rem 0.5rem 1rem 0.5rem !important;
                max-width: 98vw !important;
            }
            #custom-dialog-box {
                padding: 1.1rem 0.5rem 1rem 0.5rem !important;
                max-width: 98vw !important;
            }
            .interactive-btn {
                font-size: 0.95rem;
                padding: 0.4rem 0.7rem;
            }
        }
        @media (max-width: 480px) {
            .container { padding: 0.2rem; }
            .memory-counter {
                padding: 0.7rem 0.2rem;
                margin: 0.7rem 0;
            }
            .media-grid {
                grid-template-columns: 1fr;
                gap: 4px;
            }
            .media-item {
                height: 60vw;
                min-height: 80px;
            }
            .anniversary-content, #quit-smoking-modal > div, #custom-dialog-box {
                padding: 0.7rem 0.2rem 0.7rem 0.2rem !important;
                max-width: 99vw !important;
            }
            .interactive-btn {
                font-size: 0.9rem;
                padding: 0.3rem 0.5rem;
            }
        }
    </style>
</head>
<body>
    <div id="privacy-mask-root">
    <!-- é€šç”¨è‡ªå®šä¹‰å¼¹çª—ç»„ä»¶ï¼ˆalert/prompt/confirmï¼‰ -->
    <div id="custom-dialog-mask" style="display:none;position:fixed;z-index:200000;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.35);justify-content:center;align-items:center;"></div>
    <div id="custom-dialog" style="display:none;position:fixed;z-index:200001;top:0;left:0;width:100vw;height:100vh;justify-content:center;align-items:center;">
      <div id="custom-dialog-box" style="background:#fff;padding:1.5rem 1.2rem 1.2rem 1.2rem;border-radius:16px;max-width:340px;width:90vw;box-shadow:0 8px 32px #0005;position:relative;text-align:center;">
        <div id="custom-dialog-title" style="font-size:1.15rem;color:#ff6b9e;margin-bottom:0.7rem;"></div>
        <div id="custom-dialog-content" style="color:#333;font-size:1.05rem;margin-bottom:1rem;word-break:break-all;"></div>
        <input id="custom-dialog-input" style="display:none;width:90%;margin-bottom:1rem;padding:0.5rem;border-radius:8px;border:1px solid #eee;font-size:1rem;" />
        <div style="margin-top:0.5rem;">
          <button id="custom-dialog-ok" class="interactive-btn" style="min-width:60px;margin:0 0.5rem;">ç¡®å®š</button>
          <button id="custom-dialog-cancel" class="interactive-btn" style="background:#fff6fa;color:#ff6b9e;border:1px solid #ffb6d5;min-width:60px;margin:0 0.5rem;display:none;">å–æ¶ˆ</button>
        </div>
      </div>
    </div>
    <div id="quit-smoking-modal" style="display:none;position:fixed;z-index:100000;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.85);justify-content:center;align-items:center;">
        <div style="background:#fff;padding:2rem 1.5rem 1.2rem 1.5rem;border-radius:18px;max-width:370px;width:92vw;box-shadow:0 8px 32px #0005;position:relative;text-align:center;">
            <button onclick="closeQuitSmokingModal()" style="position:absolute;top:10px;right:16px;font-size:1.5rem;background:none;border:none;color:#888;cursor:pointer;">Ã—</button>
            <h2 style="color:#ff6b9e;margin-bottom:0.7rem;">æˆ’çƒŸæ‰“å¡</h2>
            <div id="qs-days" style="font-size:1.7rem;font-weight:bold;margin-bottom:0.2rem;"></div>
            <div id="qs-streaks" style="color:#6bd5ff;font-size:1.05rem;margin-bottom:0.2rem;"></div>
            <div id="qs-last-date" style="color:#888;font-size:0.95rem;margin-bottom:0.7rem;"></div>
            <button id="qs-punch-btn" class="interactive-btn" style="margin-bottom:0.7rem;">ä»Šæ—¥æ‰“å¡</button>
            <button id="qs-reset-btn" class="interactive-btn" style="background:#fff6fa;color:#ff6b9e;border:1px solid #ffb6d5;margin-left:0.5rem;margin-bottom:0.7rem;">é‡ç½®æ‰“å¡</button>
            <div id="qs-msg" style="margin-top:0.3rem;color:#6bd5ff;font-size:1.1rem;"></div>
            <div id="qs-history" style="margin-top:0.7rem;text-align:left;font-size:0.98rem;background:#f6faff;border-radius:10px;padding:0.7rem 0.7rem 0.5rem 0.7rem;max-height:120px;overflow-y:auto;"></div>
        </div>
    </div>
    <header>
        <div class="hearts" id="hearts-container"></div>
        <!-- ä¸»æ ‡é¢˜ï¼Œè¿ç»­ç‚¹å‡»5æ¬¡å¯è¿›å…¥æˆ’çƒŸæ‰“å¡é¡µé¢ï¼ˆéšè—å…¥å£ï¼‰ -->
        <h1 id="main-title">æˆ‘ä»¬çš„äº‘ç«¯æ‹çˆ±æ—¥è®°</h1>
        <div class="subtitle">å¼ xx â¤ï¸å–»xx | å¼€å§‹äº <span id="start-date">2025å¹´8æœˆ2æ—¥</span></div>
        <div class="real-time-clock" id="current-time">æ­£åœ¨åŠ è½½æ—¶é—´...</div>
    </header>

    <canvas id="bg-bubbles-canvas" style="position:fixed;z-index:0;top:0;left:0;width:100vw;height:100vh;pointer-events:none;"></canvas>
    <canvas id="bg-bubbles-canvas" style="position:fixed;z-index:0;top:0;left:0;width:100vw;height:100vh;pointer-events:none;"></canvas>
    
    <div class="container">
        <!-- æ‹çˆ±åŠ¨æ€åŒºå— -->
        <div class="memory-counter" style="background: #f6fff9; color: #6bd5ff; margin-bottom:2rem;">
            <h2 style="color:#6bd5ff;">æ‹çˆ±åŠ¨æ€</h2>
            <div id="love-feed-list" style="min-height:2.5em;font-size:1.08rem;line-height:1.7;"></div>
            <div id="love-feed-loading" style="color:#bbb;font-size:0.95rem;">åŠ¨æ€åŠ è½½ä¸­...</div>
        </div>
        <div class="memory-counter">
            <div class="counter-label">æˆ‘ä»¬å·²ç»ç›¸çˆ±</div>
            <div class="counter-number" id="days-together">0å¤©</div>
            <div class="counter-label" id="next-anniversary">è·ç¦»100å¤©çºªå¿µæ—¥è¿˜æœ‰83å¤©</div>
            <button class="interactive-btn" onclick="showMemoryPrompt()">æ·»åŠ æ–°å›å¿†</button>
            <button class="interactive-btn" style="background:#fff6fa;color:#ff6b9e;border:1px solid #ffb6d5;" onclick="showLuckyNote()">æŠ½ä¸€æ”¯å¹¸è¿ç­¾</button>
            <button class="interactive-btn" style="background:#f6fff9;color:#6bd5ff;border:1px solid #b6eaff;" onclick="showLoveQuiz()">æƒ…ä¾£é»˜å¥‘é—®ç­”</button>
        </div>

        <!-- ç”œèœœç›¸å†Œäº’åŠ¨åŒºå— -->
        <div class="memory-counter" style="background: #fff6fa; color: #ff6b9e; margin-bottom:2rem;">
            <h2 style="color:#ff6b9e;">ç”œèœœç›¸å†Œ</h2>
            <!-- ç›¸å†Œé¡ºåºå¦‚éœ€è°ƒæ•´è¯·åŒæ­¥ä¿®æ”¹orderå±æ€§å’Œæ³¨é‡Š -->
            <div class="media-grid" style="grid-auto-flow: row;">
                <!-- 1. ç¬¬ä¸€å¼ ç…§ç‰‡ï¼šå¾®ä¿¡å›¾ç‰‡_2025-08-07_084038_490.jpg -->
                <div class="media-item" data-img="å¾®ä¿¡å›¾ç‰‡_2025-08-07_084038_490.jpg" style="background-image: url('å¾®ä¿¡å›¾ç‰‡_2025-08-07_084038_490.jpg'); position:relative; order:1;" onclick="showImageModal('å¾®ä¿¡å›¾ç‰‡_2025-08-07_084038_490.jpg')">
                    <div class="img-blur-mask"></div>
                </div>
                <!-- 2. ç¬¬äºŒå¼ ç…§ç‰‡ï¼šå¾®ä¿¡å›¾ç‰‡_2025-08-08_094627_680.jpg -->
                <div class="media-item" data-img="å¾®ä¿¡å›¾ç‰‡_2025-08-08_094627_680.jpg" style="background-image: url('å¾®ä¿¡å›¾ç‰‡_2025-08-08_094627_680.jpg'); position:relative; order:2;" onclick="showImageModal('å¾®ä¿¡å›¾ç‰‡_2025-08-08_094627_680.jpg')">
                    <div class="img-blur-mask"></div>
                </div>
                <!-- 3. ç¬¬ä¸‰å¼ ç…§ç‰‡ï¼šå¾®ä¿¡å›¾ç‰‡_2025-08-07_084553_312.png -->
                <div class="media-item" data-img="å¾®ä¿¡å›¾ç‰‡_2025-08-07_084553_312.png" style="background-image: url('å¾®ä¿¡å›¾ç‰‡_2025-08-07_084553_312.png'); position:relative; order:3;" onclick="showImageModal('å¾®ä¿¡å›¾ç‰‡_2025-08-07_084553_312.png')">
                    <div class="img-blur-mask"></div>
                </div>
                <!-- 4. ç¬¬å››å¼ ç…§ç‰‡ï¼šå¾®ä¿¡å›¾ç‰‡_2025-08-07_084800_991.png -->
                <div class="media-item" data-img="å¾®ä¿¡å›¾ç‰‡_2025-08-07_084800_991.png" style="background-image: url('å¾®ä¿¡å›¾ç‰‡_2025-08-07_084800_991.png'); position:relative; order:4;" onclick="showImageModal('å¾®ä¿¡å›¾ç‰‡_2025-08-07_084800_991.png')">
                    <div class="img-blur-mask"></div>
                </div>
            <!-- å¦‚éœ€è°ƒæ•´é¡ºåºè¯·åŒæ­¥ä¿®æ”¹orderå±æ€§å’Œæ³¨é‡Š -->
            </div>
            <div style="margin-top:1rem;">
                <button class="interactive-btn" onclick="showAlert('å¦‚éœ€æ·»åŠ æ–°ç…§ç‰‡è¯·è”ç³»å¼€å‘è€…~')">æ·»åŠ æ–°ç…§ç‰‡</button>
            </div>
        </div>

        <!-- æ¯æ—¥ä¸€å¥äº’åŠ¨ç¥ç¦åŒºå— -->
        <div class="memory-counter" style="background: #f6fff9; color: #6bd5ff; margin-bottom:2rem;">
            <h2 style="color:#6bd5ff;">æ¯æ—¥ä¸€å¥</h2>
            <div id="daily-quote" style="font-size:1.2rem; margin:1rem 0;">åŠ è½½ä¸­...</div>
            <button class="interactive-btn" onclick="showRandomQuote()">æ¢ä¸€å¥</button>
        </div>
    <!-- å›¾ç‰‡å¤§å›¾å¼¹çª— -->
    <div id="image-modal" style="display:none;position:fixed;z-index:99999;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.8);justify-content:center;align-items:center;">
        <img id="modal-img" src="" style="max-width:90vw;max-height:80vh;border-radius:12px;box-shadow:0 8px 32px #0008;">
        <button onclick="closeImageModal()" style="position:absolute;top:30px;right:40px;font-size:2rem;background:none;border:none;color:#fff;cursor:pointer;">Ã—</button>
    </div>
    <script>
    // è‡ªå®šä¹‰å¼¹çª—ç»„ä»¶ï¼ˆalert/prompt/confirmï¼‰
    (function(){
      const mask = document.getElementById('custom-dialog-mask');
      const dialog = document.getElementById('custom-dialog');
      const box = document.getElementById('custom-dialog-box');
      const title = document.getElementById('custom-dialog-title');
      const content = document.getElementById('custom-dialog-content');
      const input = document.getElementById('custom-dialog-input');
      const okBtn = document.getElementById('custom-dialog-ok');
      const cancelBtn = document.getElementById('custom-dialog-cancel');
      let cb = null;
      let mode = 'alert';
      function closeDialog(val) {
        mask.style.display = 'none';
        dialog.style.display = 'none';
        input.value = '';
        input.style.display = 'none';
        cancelBtn.style.display = 'none';
        if(cb) cb(val);
        cb = null;
      }
      window.showAlert = function(msg, callback, optTitle) {
        mode = 'alert';
        title.textContent = optTitle || 'æç¤º';
        content.textContent = msg;
        input.style.display = 'none';
        cancelBtn.style.display = 'none';
        mask.style.display = dialog.style.display = 'flex';
        cb = callback;
      };
      window.showConfirm = function(msg, callback, optTitle) {
        mode = 'confirm';
        title.textContent = optTitle || 'è¯·ç¡®è®¤';
        content.textContent = msg;
        input.style.display = 'none';
        cancelBtn.style.display = 'inline-block';
        mask.style.display = dialog.style.display = 'flex';
        cb = callback;
      };
      window.showPrompt = function(msg, callback, optTitle, defaultVal) {
        mode = 'prompt';
        title.textContent = optTitle || 'è¯·è¾“å…¥';
        content.textContent = msg;
        input.style.display = 'block';
        input.value = defaultVal || '';
        cancelBtn.style.display = 'inline-block';
        mask.style.display = dialog.style.display = 'flex';
        cb = callback;
        setTimeout(()=>{input.focus();}, 100);
      };
      okBtn.onclick = function() {
        if(mode==='prompt') closeDialog(input.value);
        else if(mode==='confirm') closeDialog(true);
        else closeDialog();
      };
      cancelBtn.onclick = function() {
        if(mode==='prompt') closeDialog(null);
        else if(mode==='confirm') closeDialog(false);
      };
      mask.onclick = function(e) { /* ç‚¹å‡»é®ç½©ä¸å…³é—­ */ };
      dialog.onclick = function(e) { if(e.target===dialog) closeDialog(); };
      input.onkeydown = function(e) { if(e.key==='Enter') okBtn.click(); };
    })();
    // èƒŒæ™¯å½©è‰²æ°”æ³¡åŠ¨å›¾æ•ˆæœ
    (function() {
        const canvas = document.getElementById('bg-bubbles-canvas');
        if (!canvas) return;
        const ctx = canvas.getContext('2d');
        let dpr = window.devicePixelRatio || 1;
        let width = window.innerWidth, height = window.innerHeight;
        function resize() {
            dpr = window.devicePixelRatio || 1;
            width = window.innerWidth;
            height = window.innerHeight;
            canvas.width = width * dpr;
            canvas.height = height * dpr;
            canvas.style.width = width + 'px';
            canvas.style.height = height + 'px';
            ctx.setTransform(1,0,0,1,0,0);
            ctx.scale(dpr, dpr);
        }
        window.addEventListener('resize', resize);
        resize();
        // æ°”æ³¡å‚æ•°
        const colors = ['#ff6b9e', '#6bd5ff', '#ffd56b', '#9e6bff', '#baffc9', '#fff6fa'];
        const bubbles = [];
        const BUBBLE_COUNT = 18;
        for (let i = 0; i < BUBBLE_COUNT; i++) {
            bubbles.push({
                x: Math.random() * width,
                y: Math.random() * height,
                r: 20 + Math.random() * 40,
                color: colors[Math.floor(Math.random()*colors.length)],
                speed: 0.3 + Math.random() * 0.7,
                dx: (Math.random()-0.5)*0.3,
                alpha: 0.15 + Math.random()*0.15
            });
        }
        function draw() {
            ctx.clearRect(0,0,width,height);
            for (const b of bubbles) {
                ctx.save();
                ctx.globalAlpha = b.alpha;
                ctx.beginPath();
                ctx.arc(b.x, b.y, b.r, 0, Math.PI*2);
                ctx.closePath();
                ctx.fillStyle = b.color;
                ctx.shadowColor = b.color;
                ctx.shadowBlur = 16;
                ctx.fill();
                ctx.restore();
                // update
                b.y -= b.speed;
                b.x += b.dx;
                if (b.y + b.r < 0) {
                    b.y = height + b.r;
                    b.x = Math.random() * width;
                }
            }
            requestAnimationFrame(draw);
        }
        draw();
    })();

    // ç›¸å†Œå›¾ç‰‡åŠ è½½æ£€æµ‹ï¼Œè‡ªåŠ¨éšè—åŠ è½½å¤±è´¥çš„å›¾ç‰‡é¡¹
    window.addEventListener('DOMContentLoaded', function() {
        document.querySelectorAll('.media-item[data-img]').forEach(function(item) {
            var img = new window.Image();
            img.onload = function() { 
                // å›¾ç‰‡åŠ è½½æˆåŠŸï¼Œç§»é™¤åŠ è½½å¤±è´¥çš„æ ·å¼
                item.classList.remove('img-loading-failed');
                console.log('å›¾ç‰‡åŠ è½½æˆåŠŸ:', item.getAttribute('data-img'));
            };
            img.onerror = function(e) {
                // æ˜¾ç¤ºè¯¦ç»†é”™è¯¯ä¿¡æ¯
                var src = item.getAttribute('data-img');
                var msg = 'ç›¸å†Œå›¾ç‰‡åŠ è½½å¤±è´¥ï¼š' + src + '\n\n';
                if (src.startsWith('http')) {
                    msg += 'ç½‘ç»œå›¾ç‰‡åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥ï¼š\nâ€¢ ç½‘ç»œè¿æ¥\nâ€¢ å›¾ç‰‡é“¾æ¥æ˜¯å¦æœ‰æ•ˆ\nâ€¢ å›¾ç‰‡æœåŠ¡å™¨æ˜¯å¦æ­£å¸¸';
                } else {
                    msg += 'æœ¬åœ°å›¾ç‰‡åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥ï¼š\nâ€¢ å›¾ç‰‡æ–‡ä»¶æ˜¯å¦å­˜åœ¨\nâ€¢ æ–‡ä»¶åå’Œè·¯å¾„æ˜¯å¦æ­£ç¡®\nâ€¢ æ–‡ä»¶æ ¼å¼æ˜¯å¦æ”¯æŒ';
                }
                msg += '\n\nå»ºè®®ï¼š\nâ€¢ å°†å›¾ç‰‡æ–‡ä»¶æ”¾åœ¨ä¸HTMLç›¸åŒçš„ç›®å½•ä¸­\nâ€¢ æˆ–ä½¿ç”¨å®Œæ•´çš„ç½‘ç»œå›¾ç‰‡é“¾æ¥';
                
                showAlert(msg);
                // æ§åˆ¶å°è¾“å‡ºæ›´è¯¦ç»†çš„äº‹ä»¶å¯¹è±¡
                console.error('å›¾ç‰‡åŠ è½½å¤±è´¥', src, e);
                
                // æ·»åŠ åŠ è½½å¤±è´¥çš„æ ·å¼ï¼Œè€Œä¸æ˜¯ç›´æ¥éšè—
                item.classList.add('img-loading-failed');
                item.style.backgroundImage = 'url("data:image/svg+xml,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' width=\'300\' height=\'300\'%3E%3Crect width=\'300\' height=\'300\' fill=\'%23f0f0f0\'/%3E%3Ctext x=\'150\' y=\'150\' text-anchor=\'middle\' dy=\'.3em\' fill=\'%23999\' font-size=\'16\'%3Eå›¾ç‰‡åŠ è½½å¤±è´¥%3C/text%3E%3C/svg%3E")';
            };
            img.src = item.getAttribute('data-img');
        });
    });
    // ç”œèœœç›¸å†Œå¼¹çª—
    function showImageModal(url) {
        document.getElementById('modal-img').src = url;
        document.getElementById('image-modal').style.display = 'flex';
    }
    function closeImageModal() {
        document.getElementById('image-modal').style.display = 'none';
        document.getElementById('modal-img').src = '';
    }
    // æ¯æ—¥ä¸€å¥ç¥ç¦
    const quotes = [
        'æ„¿æˆ‘ä»¬ä¸€ç›´ç”œåˆ°è€ï¼Œå²æœˆé™å¥½ã€‚',
        'ä½ ç¬‘èµ·æ¥çœŸåƒå¤å¤©çš„é£ã€‚',
        'å’Œä½ åœ¨ä¸€èµ·ï¼Œæ¯ä¸€å¤©éƒ½å€¼å¾—çºªå¿µã€‚',
        'ä¸–ç•Œå¾ˆå¤§ï¼Œé‡è§ä½ åˆšåˆšå¥½ã€‚',
        'ä½ æ˜¯æˆ‘æœ€ç¾çš„é£æ™¯ã€‚',
        'é™ªä½ çœ‹æ—¥è½çš„äººæ¯”æ—¥è½æ›´æ¸©æŸ”ã€‚',
        'æˆ‘å–œæ¬¢ä½ ï¼Œåƒé£èµ°äº†å…«åƒé‡Œï¼Œä¸é—®å½’æœŸã€‚',
        'ä½ æ˜¯æˆ‘å¿ƒé‡Œçš„å°å¤ªé˜³ã€‚',
        'æœ‰ä½ åœ¨ï¼Œè¿å¹³å‡¡çš„æ—¥å­éƒ½é—ªé—ªå‘å…‰ã€‚',
        'ä½™ç”Ÿè¯·å¤šæŒ‡æ•™ã€‚',
        'ä½ çš„å‡ºç°è®©æˆ‘çš„ä¸–ç•Œå˜å¾—æ¸©æŸ”åˆæ˜äº®ã€‚',
        'æ¯å¤©é†’æ¥ç¬¬ä¸€ä»¶äº‹å°±æ˜¯æƒ³ä½ ã€‚',
        'ä½ æ˜¯æˆ‘å¿ƒä¸­æ°¸è¿œçš„å®è—ã€‚',
        'æœ‰ä½ çš„æ—¥å­ï¼Œè¿ç©ºæ°”éƒ½æ˜¯ç”œçš„ã€‚',
        'æƒ³å’Œä½ ä¸€èµ·çœ‹éå››å­£çš„é£æ™¯ã€‚',
        'ä½ æ˜¯æˆ‘æœ€æ¸©æš–çš„ä¾é ã€‚',
        'é‡è§ä½ ï¼Œæ˜¯æˆ‘æœ€ç¾çš„æ„å¤–ã€‚',
        'ä½ çš„ç¬‘å®¹æ˜¯æˆ‘æ¯å¤©çš„åŠ¨åŠ›ã€‚',
        'å’Œä½ åœ¨ä¸€èµ·ï¼Œæ—¶é—´æ€»æ˜¯è¿‡å¾—å¤ªå¿«ã€‚',
        'æ„¿æˆ‘ä»¬çš„æ•…äº‹æ²¡æœ‰ç»“å±€ï¼Œåªå‰©å¹¸ç¦ã€‚'
    ];
    function showRandomQuote() {
        const idx = Math.floor(Math.random() * quotes.length);
        document.getElementById('daily-quote').textContent = quotes[idx];
    }
    // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ˜¾ç¤ºä¸€å¥
    window.addEventListener('DOMContentLoaded', function() {
        showRandomQuote();
    });
    // æ‹çˆ±åŠ¨æ€è‡ªåŠ¨åŠ è½½ï¼ˆæ”¯æŒå›¾ç‰‡å’Œè§†é¢‘ï¼‰
    /*
    love-feed.json æ¯æ¡åŠ¨æ€å¯åŒ…å«ï¼š
    {
      "date": "2025-08-08",
      "text": "ä¸€èµ·çœ‹äº†ç”µå½±ï¼Œè¶…çº§å¼€å¿ƒï¼",
      "img": "movie.jpg", // å¯é€‰ï¼Œå›¾ç‰‡è·¯å¾„æˆ–URL
      "video": "movie.mp4" // å¯é€‰ï¼Œè§†é¢‘è·¯å¾„æˆ–URL
    }
    å›¾ç‰‡å’Œè§†é¢‘å­—æ®µå‡ä¸ºå¯é€‰ï¼Œæ”¯æŒæœ¬åœ°æ–‡ä»¶æˆ–ç½‘ç»œé“¾æ¥ã€‚å›¾ç‰‡å»ºè®®æ”¾åœ¨åŒç›®å½•æˆ–imgå­ç›®å½•ï¼Œè§†é¢‘åŒç†ã€‚
    */
    (function(){
        const feedList = document.getElementById('love-feed-list');
        const feedLoading = document.getElementById('love-feed-loading');
        fetch('love-feed.json?_t='+Date.now())
        .then(r=>r.ok?r.json():[])
        .then(list=>{
            feedLoading.style.display = 'none';
            if(!Array.isArray(list)||list.length===0){
                feedList.innerHTML = '<span style="color:#bbb;">æš‚æ— åŠ¨æ€</span>';
                return;
            }
            feedList.innerHTML = list.map(item=>{
                let html = `<div style='margin-bottom:0.9em;'><span style='color:#ff6b9e;font-weight:bold;'>${item.date}</span>ï¼š${item.text || ''}`;
                if(item.img){
                    html += `<br><img src='${item.img}' alt='åŠ¨æ€å›¾ç‰‡' style='max-width:90%;margin-top:0.3em;border-radius:8px;box-shadow:0 2px 8px #0001;'>`;
                }
                if(item.video){
                    html += `<br><video src='${item.video}' controls style='max-width:90%;margin-top:0.3em;border-radius:8px;box-shadow:0 2px 8px #0001;'></video>`;
                }
                html += '</div>';
                return html;
            }).join('');
        })
        .catch(()=>{
            feedLoading.textContent = 'åŠ¨æ€åŠ è½½å¤±è´¥';
        });
    })();
    </script>
        
        <div class="timeline">
            <!-- åˆé‡æ¬¡å…ƒ -->
            <div class="timeline-item">
                <div class="timeline-date">2025.6</div>
                <div class="timeline-content">
                    <h2 class="timeline-title">ğŸŒ åˆé‡æ¬¡å…ƒ</h2>
                    <p class="timeline-text">2025å¹´6æœˆ7æ—¥ï¼Œå‘½è¿çš„é½¿è½®å¼€å§‹è½¬åŠ¨ï¼é€šè¿‡åŒå­¦çš„å¿«æ‰‹åˆ†äº«ï¼Œæˆ‘ç¬¬ä¸€æ¬¡çœ‹åˆ°äº†ä½ ã€‚é‚£ä¸€åˆ»ï¼Œä»¿ä½›æ•´ä¸ªå®‡å®™éƒ½åœ¨å‘Šè¯‰æˆ‘ï¼šè¿™ä¸ªå¥³å­©ï¼Œå€¼å¾—æˆ‘ç”¨ä¸€ç”Ÿå»çæƒœã€‚</p>
                    <div class="timeline-quote">"è¿˜è®°å¾—åŠ ä½ å¥½å‹åçš„ç¬¬ä¸€å¥è¯å—ï¼Ÿ'ä½ å¥½'â€”â€”å¤šä¹ˆç®€å•çš„ä¸¤ä¸ªå­—ï¼Œå´æ˜¯æˆ‘äººç”Ÿæœ€ç¾å¥½çš„å¼€å§‹ã€‚åŸæœ¬åªæƒ³åšæœ‹å‹ï¼Œè°çŸ¥é“......"</div>
                    <div class="media-grid">
                        <div class="media-item" style="background-image: url('å¾®ä¿¡å›¾ç‰‡_20250806001442_7.jpg'); position:relative;">
                            <div class="img-blur-mask"></div>
                        </div>
                        <div class="media-item" style="background-image: url('å¾®ä¿¡å›¾ç‰‡_2025-08-08_101314_565.jpg'); position:relative;">
                            <div class="img-blur-mask"></div>
        <style>
        .img-blur-mask {
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            width: 100%; height: 100%;
            /* backdrop-filter: blur(8px); */ /* ç§»é™¤æ¨¡ç³Šæ•ˆæœ */
            background: transparent; /* ç§»é™¤åŠé€æ˜ç™½è‰²èƒŒæ™¯ */
            border-radius: 8px;
            z-index: 2;
            pointer-events: none;
        }
        </style>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- ç ´å£æ—¶åˆ» -->
            <div class="timeline-item">
                <div class="timeline-date">2025.7</div>
                <div class="timeline-content">
                    <h2 class="timeline-title">ğŸ’¬ ç ´å£æ—¶åˆ»</h2>
                    <p class="timeline-text">7æœˆçš„æŸä¸ªå¤œæ™šï¼Œæˆ‘ä»¬èŠåˆ°å¾ˆæ™šå¾ˆæ™šã€‚ä½ çªç„¶æ•å¼€å¿ƒæ‰‰ï¼Œåˆ†äº«äº†å¾ˆå¤šå†…å¿ƒçš„æƒ³æ³•ã€‚é‚£ä¸€åˆ»ï¼Œæˆ‘ä»¿ä½›çœ‹åˆ°äº†ä¸€ä¸ªé—ªé—ªå‘å…‰çš„çµé­‚â€”â€”ä½ çš„æ´»æ³¼ã€çƒ­æƒ…ã€èªæ•ï¼Œè¿˜æœ‰é‚£ä»½çº¯çœŸçš„å–„è‰¯ï¼Œå½»åº•å‡»ä¸­äº†æˆ‘çš„å¿ƒã€‚</p>
                    <p class="timeline-text">7æœˆ29æ—¥ï¼Œæˆ‘ä»¬ç¬¬ä¸€æ¬¡è§†é¢‘é€šè¯ï¼ä½ å®³ç¾åœ°ç”¨ç‰¹æ•ˆæŒ¡ç€è„¸ï¼Œä½†æˆ‘ä¾ç„¶èƒ½çœ‹åˆ°ä½ é‚£åŒç¬‘èµ·æ¥åƒæœˆç‰™ä¸€æ ·ç¾çš„çœ¼ç›ã€‚é‚£ä¸€åˆ»ï¼Œæˆ‘çŸ¥é“æˆ‘å·²ç»æ— æ³•è‡ªæ‹”äº†ã€‚</p>
                    <button class="interactive-btn" onclick="playOurSong()">æ’­æ”¾æˆ‘ä»¬çš„æ­Œ</button>
                    <button class="interactive-btn" onclick="searchAndPlaySong()">åˆ‡æ¢ç½‘æ˜“äº‘æ­Œæ›²</button> <!-- æ–°å¢æŒ‰é’®ï¼Œç‚¹å‡»å¼¹çª—è¾“å…¥ç½‘æ˜“äº‘ID -->
                </div>
            </div>

            <!-- å…³ç³»å‡çº§ -->
            <div class="timeline-item">
                <div class="timeline-date">2025.7.20</div>
                <div class="timeline-content">
                    <h2 class="timeline-title">ğŸš€ å…³ç³»å‡çº§</h2>
                    <p class="timeline-text">2025å¹´8æœˆ2æ—¥å‡Œæ™¨5ç‚¹20åˆ†ï¼Œè¿™ä¸ªå……æ»¡é­”åŠ›çš„æ—¶åˆ»ï¼æˆ‘åœ¨QQä¸Šé¼“èµ·å‹‡æ°”ï¼Œå‘ä½ å‘é€äº†é‚£å¥æ”¹å˜æˆ‘ä»¬å‘½è¿çš„è¯ã€‚å½“ä½ å›å¤"æˆ‘åŒæ„ï¼"çš„é‚£ä¸€åˆ»ï¼Œæˆ‘çš„ä¸–ç•Œç¬é—´è¢«ç²‰è‰²çš„æ³¡æ³¡å¡«æ»¡ï¼Œä»¿ä½›æ•´ä¸ªå®‡å®™éƒ½åœ¨ä¸ºæˆ‘ä»¬åº†ç¥ï¼</p>
                    <p class="timeline-text">ä»æ­¤ï¼Œæˆ‘ä»¬æœ‰äº†ä¸“å±çš„æƒ…ä¾£æ ‡å¿—ï¼šé‚£äº›åªå±äºæˆ‘ä»¬ä¸¤ä¸ªäººçš„äº²æ˜µç§°å‘¼ï¼Œè¿˜æœ‰é‚£å¯¹è±¡å¾ç€å½¼æ­¤èƒŒæ™¯çš„ç”œèœœå¤´åƒã€‚æ¯ä¸€ä¸ªç»†èŠ‚éƒ½åœ¨è¯‰è¯´ç€æˆ‘ä»¬çš„ä¸“å±æ•…äº‹ã€‚</p>
                    <div class="media-grid">
                        <div class="media-item" style="background-image: url('å¾®ä¿¡å›¾ç‰‡_2025-08-05_232113_934.jpg')"></div>
                    </div>
                </div>
            </div>
            
            <!-- äº‘ç«¯ç”œèœœæ¸…å• -->
            <div class="timeline-item">
                <div class="timeline-date">2025.8</div>
                <div class="timeline-content">
                    <h2 class="timeline-title">ğŸ’» äº‘ç«¯ç”œèœœæ¸…å•</h2>
                    <p class="timeline-text">æˆ‘ä»¬ä¸€èµ·å®Œæˆçš„äº‹ï¼š</p>
                    <ul class="timeline-list">
                        <li>Thinking~</li>
                        <li>Thinking~</li>
                        <li>Thinking~</li>
                    </ul>
                    <p class="timeline-text">äº’ç›¸é€è¿‡çš„è™šæ‹Ÿç¤¼ç‰©ï¼š</p>
                    <ul class="timeline-list">
                        <li>Thinking~</li>
                        <li>Thinking~</li>
                    </ul>
                    <button class="interactive-btn" onclick="showLoveCalculator()">æµ‹è¯•æˆ‘ä»¬çš„åŒ¹é…åº¦</button>
                </div>
            </div>
            
            <!-- æœªæ¥ä¿¡å·å¡” -->
            <div class="timeline-item">
                <div class="timeline-date">æœªæ¥</div>
                <div class="timeline-content">
                    <h2 class="timeline-title">ğŸ“¡ æœªæ¥ä¿¡å·å¡”</h2>
                    <p class="timeline-text">æˆ‘ä»¬è®¡åˆ’åœ¨......ç¬¬ä¸€æ¬¡è§é¢ï¼Œåœ°ç‚¹å®šåœ¨......</p>
                    <p class="timeline-text">é•¿è¿œçš„æ¢¦æƒ³ï¼š</p>
                    <ul class="timeline-list">
                        <li>Thinking~</li>
                        <li>Thinking~</li>
                        <li>Thinking~</li>
                    </ul>
                    <div id="countdown" style="margin-top: 1rem;"></div>
                </div>
            </div>
        </div>
    </div>
    
    <footer>
        <p>ç”¨ä»£ç ç¼–ç»‡çš„çˆ±æ„ | æœ€åæ›´æ–°äº <span id="update-date"></span></p>
        <p>å¼€å‘è€…wechatï¼šzly_137,QQ:2369157249(æ³¨æ˜æ¥æ„ï¼)</p>
        <button class="interactive-btn" style="margin-top:1rem;background:#fff6fa;color:#ff6b9e;border:1px solid #ffb6d5;" onclick="showWhisperInput()">å†™ä¸€å¥æ‚„æ‚„è¯</button>
        <button class="interactive-btn" style="margin-top:1rem;background:#f6fff9;color:#6bd5ff;border:1px solid #b6eaff;" onclick="showConfessionWall()">è¡¨ç™½å¢™</button>
    </footer>

    <!-- æ‚„æ‚„è¯å¼¹å¹•å®¹å™¨ -->
    <div id="whisper-barrage-container" style="position:fixed;left:0;bottom:40px;width:100vw;z-index:99998;pointer-events:none;"></div>

    <script>
    // é¡µé¢ç‚¹å‡»éšæœºé£˜è½çˆ±å¿ƒåŠ¨ç”»
    document.addEventListener('click', function(e) {
        // åªåœ¨ä¸»åŒºåŸŸç‚¹å‡»æ‰è§¦å‘
        if (e.target.closest('button,.media-item,#image-modal')) return;
        const heart = document.createElement('div');
        heart.textContent = 'ğŸ’–';
        heart.style.position = 'fixed';
        heart.style.left = e.clientX - 16 + 'px';
        heart.style.top = e.clientY - 16 + 'px';
        heart.style.fontSize = (24 + Math.random()*16) + 'px';
        heart.style.opacity = 0.85;
        heart.style.pointerEvents = 'none';
        heart.style.transition = 'transform 1.2s cubic-bezier(.2,1.2,.4,1), opacity 1.2s';
        heart.style.transform = 'translateY(0) scale(1)';
        document.body.appendChild(heart);
        setTimeout(()=>{
            heart.style.transform = `translateY(-120px) scale(${1.2+Math.random()*0.6})`;
            heart.style.opacity = 0;
        }, 10);
        setTimeout(()=>heart.remove(), 1300);
    });

// å¹¸è¿ç­¾åŠŸèƒ½
function showLuckyNote() {
    const notes = [
        'ä½ ä»¬çš„çˆ±æƒ…ä¼šåƒä»Šå¤©çš„é˜³å…‰ä¸€æ ·æ¸©æš–æ˜äº®~',
        'æœªæ¥çš„æ¯ä¸€å¤©éƒ½å€¼å¾—æœŸå¾…ï¼Œç”œèœœä¼šä¸€ç›´å»¶ç»­ï¼',
        'ä½ ä»¬çš„æ•…äº‹ä¼šæ¯”ç«¥è¯æ›´ç¾å¥½~',
        'å¹¸ç¦å°±åœ¨èº«è¾¹ï¼Œçæƒœæ¯ä¸€æ¬¡å¿ƒåŠ¨~',
        'æ„¿ä½ ä»¬çš„æ„Ÿæƒ…åƒå¹¸è¿ç­¾ä¸€æ ·ï¼ŒæŠ½åˆ°çš„éƒ½æ˜¯å¥½æ¶ˆæ¯ï¼',
        'ä»Šå¤©ä¼šæœ‰å°æƒŠå–œé™ä¸´å“¦ï¼',
        'ä½ ä»¬çš„é»˜å¥‘å€¼å·²æ»¡åˆ†ï¼',
        'çˆ±æ„å¦‚åˆï¼Œç”œèœœå¦‚æ•…ã€‚',
        'ä½ ä»¬çš„æœªæ¥ä¼šå¾ˆé—ªè€€ï¼',
        'æ„¿ä½ ä»¬çš„æ¯ä¸€å¤©éƒ½è¢«çˆ±åŒ…å›´~'
    ];
        const idx = Math.floor(Math.random() * notes.length);
        showAlert('ğŸ å¹¸è¿ç­¾ï¼š\n' + notes[idx]);
}

// è¡¨ç™½å¢™å¼¹å¹•åŠŸèƒ½
function showConfessionWall() {
    showPrompt('åœ¨è¡¨ç™½å¢™å†™ä¸‹ä½ çš„å¿ƒé‡Œè¯ï¼ˆä¼šä»¥å¼¹å¹•å½¢å¼é£˜è¿‡é¡µé¢é¡¶éƒ¨ï¼‰ï¼š', function(confession) {
        if (confession && confession.trim()) {
            addConfessionBarrage(confession.trim());
        }
    });
}
function addConfessionBarrage(text) {
    let container = document.getElementById('confession-barrage-container');
    if (!container) {
        container = document.createElement('div');
        container.id = 'confession-barrage-container';
        container.style.position = 'fixed';
        container.style.left = '0';
        container.style.top = '20px';
        container.style.width = '100vw';
        container.style.zIndex = '99999';
        container.style.pointerEvents = 'none';
        document.body.appendChild(container);
    }
    const span = document.createElement('span');
    span.textContent = text;
    span.style.position = 'absolute';
    span.style.left = '100vw';
    span.style.top = (Math.random()*20) + 'px';
    span.style.whiteSpace = 'nowrap';
    span.style.fontSize = (18+Math.random()*8)+'px';
    span.style.color = ['#ff6b9e','#6bd5ff','#ffd56b','#9e6bff','#baffc9'][Math.floor(Math.random()*5)];
    span.style.background = 'rgba(255,255,255,0.85)';
    span.style.borderRadius = '16px';
    span.style.padding = '4px 16px';
    span.style.marginRight = '8px';
    span.style.boxShadow = '0 2px 8px #0001';
    span.style.opacity = 0.98;
    span.style.pointerEvents = 'none';
    const duration = 8 + Math.random()*3;
    span.style.transition = `transform ${duration}s linear`;
    container.appendChild(span);
    setTimeout(()=>{
        span.style.transform = `translateX(-110vw)`;
    }, 30);
    setTimeout(()=>span.remove(), duration*1000+1000);
}

// æƒ…ä¾£é»˜å¥‘é—®ç­”åŠŸèƒ½
function showLoveQuiz() {
    const quizList = [
        {
            q: 'ç¬¬ä¸€æ¬¡è§é¢ä½ ä»¬æœ€æƒ³åšä»€ä¹ˆï¼Ÿ',
            a: ['A. æ‹¥æŠ±', 'B. åƒå¥½åƒçš„', 'C. çœ‹ç”µå½±', 'D. ä¸€èµ·æ•£æ­¥']
        },
        {
            q: 'ä½ è§‰å¾—å¯¹æ–¹æœ€å¯çˆ±çš„åœ°æ–¹æ˜¯ï¼Ÿ',
            a: ['A. ç¬‘å®¹', 'B. å£°éŸ³', 'C. æ€§æ ¼', 'D. çœ¼ç›']
        },
        {
            q: 'ä½ ä»¬æœ€æƒ³ä¸€èµ·å»çš„åœ°æ–¹ï¼Ÿ',
            a: ['A. æµ·è¾¹', 'B. æ¸¸ä¹å›­', 'C. å±±é¡¶', 'D. å®¶é‡Œ']
        },
        {
            q: 'è°æ›´å®¹æ˜“å…ˆè®¤é”™ï¼Ÿ',
            a: ['A. æˆ‘', 'B. å¯¹æ–¹', 'C. çœ‹æƒ…å†µ', 'D. éƒ½ä¸è®¤é”™']
        },
        {
            q: 'ä½ ä»¬çš„çˆ±æƒ…ä¸»é¢˜è‰²æ˜¯ï¼Ÿ',
            a: ['A. ç²‰è‰²', 'B. è“è‰²', 'C. é»„è‰²', 'D. ç´«è‰²']
        },
        {
            q: 'ä½ ä»¬ç¬¬ä¸€æ¬¡çº¦ä¼šæœ€éš¾å¿˜çš„ç¬é—´æ˜¯ï¼Ÿ',
            a: ['A. ç‰µæ‰‹', 'B. æ‹ç…§', 'C. åƒç¾é£Ÿ', 'D. çœ‹ç”µå½±']
        },
        {
            q: 'å¯¹æ–¹æœ€å–œæ¬¢çš„é¥®æ–™æ˜¯ï¼Ÿ',
            a: ['A. å¥¶èŒ¶', 'B. å’–å•¡', 'C. æœæ±', 'D. ç¢³é…¸é¥®æ–™']
        },
        {
            q: 'ä½ ä»¬æœ€å¸¸ç”¨çš„æƒ…ä¾£æ˜µç§°æ˜¯ï¼Ÿ',
            a: ['A. å®å®', 'B. äº²çˆ±çš„', 'C. å°çŒª', 'D. ç‹¬å®¶æ˜µç§°']
        },
        {
            q: 'è°æ›´çˆ±åƒé›¶é£Ÿï¼Ÿ',
            a: ['A. æˆ‘', 'B. å¯¹æ–¹', 'C. éƒ½çˆ±', 'D. éƒ½ä¸çˆ±']
        },
        {
            q: 'ä½ ä»¬æœ€æƒ³ä¸€èµ·å®Œæˆçš„æ„¿æœ›æ˜¯ï¼Ÿ',
            a: ['A. ä¸€èµ·æ—…è¡Œ', 'B. æ‹æƒ…ä¾£å†™çœŸ', 'C. å…»å® ç‰©', 'D. å…±åŒä¹°æˆ¿']
        },
        {
            q: 'å¯¹æ–¹æœ€æ€•çš„ä¸œè¥¿æ˜¯ï¼Ÿ',
            a: ['A. æ˜†è™«', 'B. é»‘æš—', 'C. é«˜ç©º', 'D. ç‹¬å¤„']
        },
        {
            q: 'ä½ ä»¬æœ€å–œæ¬¢ä¸€èµ·åšçš„äº‹æƒ…ï¼Ÿ',
            a: ['A. çœ‹ç”µå½±', 'B. æ•£æ­¥', 'C. åšé¥­', 'D. æ‰“æ¸¸æˆ']
        },
        {
            q: 'è°æ›´å–œæ¬¢æ’’å¨‡ï¼Ÿ',
            a: ['A. æˆ‘', 'B. å¯¹æ–¹', 'C. éƒ½ä¼š', 'D. éƒ½ä¸æ’’å¨‡']
        },
        {
            q: 'ä½ ä»¬çš„ä¸“å±çºªå¿µæ—¥æ˜¯å“ªä¸€å¤©ï¼Ÿ',
            a: ['A. ç¬¬ä¸€æ¬¡è§é¢', 'B. è¡¨ç™½æ—¥', 'C. ç‰µæ‰‹æ—¥', 'D. å…¶å®ƒ']
        },
        {
            q: 'å¯¹æ–¹æœ€å–œæ¬¢çš„å­£èŠ‚æ˜¯ï¼Ÿ',
            a: ['A. æ˜¥å¤©', 'B. å¤å¤©', 'C. ç§‹å¤©', 'D. å†¬å¤©']
        },
        {
            q: 'ä½ ä»¬æœ€å¸¸ä¸€èµ·ç‚¹çš„å¤–å–æ˜¯ä»€ä¹ˆï¼Ÿ',
            a: ['A. ç«é”…', 'B. çƒ§çƒ¤', 'C. å¥¶èŒ¶ç”œå“', 'D. å¿«é¤']
        }
    ];
    const idx = Math.floor(Math.random() * quizList.length);
    const quiz = quizList[idx];
    showPrompt('æƒ…ä¾£é»˜å¥‘é—®ç­”ï¼š\n' + quiz.q + '\n' + quiz.a.join('  '), function(answer) {
        if (answer) {
            showAlert('ç­”æ¡ˆå·²è®°å½•ï¼å¿«å’ŒTAå¯¹ç­”æ¡ˆå§~\nä½ é€‰çš„æ˜¯ï¼š' + answer);
        }
    });
}

    // æ‚„æ‚„è¯å¼¹å¹•åŠŸèƒ½
function showWhisperInput() {
    showPrompt('è¯·è¾“å…¥æ‚„æ‚„è¯æƒé™å¯†ç ï¼š', function(pwd) {
        if (pwd !== 'zlyloveyzl') {
            if (pwd !== null) showAlert('å¯†ç é”™è¯¯ï¼Œæ— æƒé™è¾“å…¥æ‚„æ‚„è¯ï¼');
            return;
        }
        showPrompt('å†™ä¸€å¥æ‚„æ‚„è¯ï¼ˆä¼šä»¥å¼¹å¹•å½¢å¼é£˜è¿‡é¡µé¢åº•éƒ¨ï¼‰ï¼š', function(msg) {
            if (msg && msg.trim()) {
                // æ•æ„Ÿè¯åˆ—è¡¨ï¼Œå¯æ ¹æ®éœ€è¦æ‰©å±•
                const badWords = [
                    'å‚»é€¼','sb','å¦ˆçš„','æ“','fuck','shit','è‰','ç‹—','æ­»','æ»š','è´±','bitch','cnm','mlgb','ç…ç¬”','ä½ å¦ˆ','ä»–å¦ˆ','æ—¥ä½ ','å±Œ','é¸¡å·´','é˜´é“','é˜³ç—¿','é«˜æ½®','è‚','å©Šå­','æ‚ç§','ç•œç”Ÿ','ç‹å…«','äºŒé€¼','å¼±æ™º','æ™ºéšœ','è„‘æ®‹','ç™½ç—´','åºŸç‰©','åƒåœ¾','å˜æ€','æ·«','è‰²é¬¼','å°ä¸‰','å°è´±','è´±äºº','ç‹—ä¸œè¥¿','ç‹—å±','ç‹—æ—¥','ç‹—å¨˜å…»çš„','çŒª','è ¢','sb','tmd','nm','nmsl','nt','nmh','nmgb','nmzb','nmmp','nmll','nmzl','nmzj','nmzz','nmml','nmb','nmw','nmgd','nmgg','nmgn','nmgs','nmgl','nmga','nmge','nmgr','nmgt','nmgy','nmgh','nmgi','nmgo','nmgu','nmgi','nmga','nmgb','nmgsb','nmgnb','nmglb','nmglg','nmgls','nmglw','nmglz','nmglx','nmglc','nmglv','nmglf','nmglp','nmglq','nmglr','nmglj','nmglk','nmglh','nmglm','nmglb','nmglg','nmgls','nmglw','nmglz','nmglx','nmglc','nmglv','nmglf','nmglp','nmglq','nmglr','nmglj','nmglk','nmglh','nmglm','nmglb','nmglg','nmgls','nmglw','nmglz','nmglx','nmglc','nmglv','nmglf','nmglp','nmglq','nmglr','nmglj','nmglk','nmglh','nmglm','sé€¼','è ¢çŒª'
                ];
                const lowerMsg = msg.trim().toLowerCase();
                let hasBad = false;
                for (let i = 0; i < badWords.length; i++) {
                    if (lowerMsg.includes(badWords[i])) {
                        hasBad = true;
                        break;
                    }
                }
                if (hasBad) {
                    showAlert('å†…å®¹åŒ…å«ä¸æ–‡æ˜ç”¨è¯­ï¼Œè¯·é‡æ–°è¾“å…¥~');
                    return;
                }
                addWhisperBarrage(msg.trim());
            }
        });
    });
}
    function addWhisperBarrage(text) {
        const container = document.getElementById('whisper-barrage-container');
        const span = document.createElement('span');
        span.textContent = text;
        span.style.position = 'absolute';
        span.style.left = '100vw';
        span.style.bottom = (Math.random()*20) + 'px';
        span.style.whiteSpace = 'nowrap';
        span.style.fontSize = (18+Math.random()*8)+'px';
        span.style.color = ['#ff6b9e','#6bd5ff','#ffd56b','#9e6bff','#baffc9'][Math.floor(Math.random()*5)];
        span.style.background = 'rgba(255,255,255,0.7)';
        span.style.borderRadius = '16px';
        span.style.padding = '4px 16px';
        span.style.marginRight = '8px';
        span.style.boxShadow = '0 2px 8px #0001';
        span.style.opacity = 0.95;
        span.style.pointerEvents = 'none';
        const duration = 7 + Math.random()*3;
        span.style.transition = `transform ${duration}s linear`;
        container.appendChild(span);
        // åŠ¨ç”»
        setTimeout(()=>{
            span.style.transform = `translateX(-110vw)`;
        }, 30);
        setTimeout(()=>span.remove(), duration*1000+1000);
    }
        // é…ç½®é¡¹ - ä¸ªæ€§åŒ–ç½‘é¡µ
        const CONFIG = {
            startDate: '2025-08-02T05:20:00', // å…³ç³»ç¡®ç«‹æ—¥æœŸ
            names: {
                me: 'å¼ xx',
                you: 'å–»xx'
            },
            anniversaries: [
                { days: 7, title: "ğŸ‰ æ‹çˆ±ä¸€å‘¨çºªå¿µ", message: "ç”œèœœçš„ç¬¬ä¸€å‘¨åªæ˜¯å¼€å§‹å“¦~" },
                { days: 30, title: "ğŸŒ™ æ»¡æœˆå¿«ä¹", message: "ä¸€ä¸ªæœˆçš„ç³–åˆ†è¶…æ ‡è­¦å‘Šï¼" },
                { days: 100, title: "ğŸ’¯ ç™¾æ—¥æˆå°±", message: "100å¤©åªæ˜¯æˆ‘ä»¬æ•…äº‹çš„åºç« " },
                { days: 365, title: "ğŸŒ¸ å‘¨å¹´çºªå¿µ", message: "ä¸€å¹´å››å­£ï¼Œæœ€çˆ±æœ‰ä½ " },
                { days: 520, title: "ğŸ’– 520æˆ‘çˆ±ä½ ", message: "è¿™ä¸ªæ—¥å­å¤©ç”Ÿå±äºæˆ‘ä»¬" }
            ],
            ourSong: 'https://music.163.com/song/media/outer/url?id=568389828.mp3' // æ›¿æ¢ä¸ºä½ ä»¬çš„æ­Œï¼Œåªæ”¹musicIDéƒ¨åˆ†
        };
        
        // åˆå§‹åŒ–é¡µé¢å†…å®¹
        function initPage() {
            document.title = `æˆ‘ä»¬çš„äº‘ç«¯æ‹çˆ±æ—¥è®° | ${CONFIG.names.me} & ${CONFIG.names.you}`;
            document.querySelector('h1').textContent = 'æˆ‘ä»¬çš„äº‘ç«¯æ‹çˆ±æ—¥è®°';
            document.querySelector('.subtitle').innerHTML = 
                `${CONFIG.names.me} â¤ï¸ ${CONFIG.names.you} | å§‹äº <span id="start-date">${formatDate(new Date(CONFIG.startDate))}</span>`;
        }
        
        // æ¼‚æµ®çˆ±å¿ƒæ•ˆæœ
        function createHearts() {
            const container = document.getElementById('hearts-container');
            const colors = ['#ff6b9e', '#6bd5ff', '#ffd56b', '#9e6bff'];
            
            for (let i = 0; i < 20; i++) {
                const heart = document.createElement('div');
                heart.className = 'heart';
                heart.innerHTML = 'â¤ï¸';
                heart.style.left = Math.random() * 100 + '%';
                heart.style.top = Math.random() * 100 + '%';
                heart.style.color = colors[Math.floor(Math.random() * colors.length)];
                heart.style.animationDelay = Math.random() * 5 + 's';
                container.appendChild(heart);
            }
        }
        
        // æ›´æ–°å®æ—¶æ—¶é—´
        function updateCurrentTime() {
            const now = new Date();
            document.getElementById('current-time').textContent = 
                `å½“å‰æ—¶é—´: ${now.getFullYear()}å¹´${now.getMonth()+1}æœˆ${now.getDate()}æ—¥ ` + 
                `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}:${now.getSeconds().toString().padStart(2, '0')}`;
        }
        
        // ç²¾ç¡®è®¡æ—¶å’Œ100å¤©çºªå¿µæ—¥å€’è®¡æ—¶
        function updateTimeTogether() {
            const startDate = new Date(CONFIG.startDate);
            const now = new Date();
            const diff = now - startDate;
            // è®¡ç®—æ—¶é—´å·®
            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((diff % (1000 * 60)) / 1000);
            // æ›´æ–°æ—¶é—´æ˜¾ç¤º
            document.getElementById('days-together').innerHTML = 
                `${days}å¤©<span class="small">${hours}å°æ—¶${minutes}åˆ†${seconds}ç§’</span>`;
            // åªæ˜¾ç¤º100å¤©çºªå¿µæ—¥å€’è®¡æ—¶
            const daysLeft = 100 - days;
            document.getElementById('next-anniversary').textContent = 
                daysLeft > 0 ? `è·ç¦»100å¤©çºªå¿µæ—¥è¿˜æœ‰${daysLeft}å¤©` : `å·²ç»è¶…è¿‡100å¤©çºªå¿µæ—¥${-daysLeft}å¤©å•¦ï¼`;
            // æ›´æ–°å€’è®¡æ—¶
            updateCountdown();
        }
        
        // æ›´æ–°è§é¢å€’è®¡æ—¶
        function updateCountdown() {
            const meetDate = new Date('2026-08-02T00:00:00'); // ä¿®æ”¹ä¸ºä½ ä»¬çš„è§é¢æ—¥æœŸ
            const now = new Date();
            const diff = meetDate - now;
            
            if (diff > 0) {
                const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                
                document.getElementById('countdown').innerHTML = 
                    `<p>è·ç¦»è§é¢è¿˜æœ‰: <strong>${days}å¤©${hours}å°æ—¶${minutes}åˆ†</strong></p>`;
            } else {
                document.getElementById('countdown').innerHTML = 
                    `<p>æˆ‘ä»¬å·²ç»è§é¢å•¦ï¼ğŸ‰ ä¸‹æ¬¡è§é¢å€’è®¡æ—¶å¯ä»¥ä¿®æ”¹ä»£ç è®¾ç½®~</p>`;
            }
        }
        
        // çºªå¿µæ—¥å½©è›‹
        function checkAnniversary(days) {
            const anniversary = CONFIG.anniversaries.find(a => a.days === days);
            if (anniversary && !localStorage.getItem(`anniversary-${days}`)) {
                showAnniversaryPopup(anniversary);
                localStorage.setItem(`anniversary-${days}`, 'shown');
            }
        }
        
        // æ˜¾ç¤ºçºªå¿µæ—¥å¼¹çª—
        function showAnniversaryPopup(anniversary) {
            const popup = document.createElement('div');
            popup.className = 'anniversary-popup';
            popup.innerHTML = `
                <div class="anniversary-content">
                    <button class="close-btn" onclick="this.parentNode.parentNode.remove()">Ã—</button>
                    <h2 style="color: var(--primary);">${anniversary.title}</h2>
                    <p style="font-size: 1.2rem;">${anniversary.message}</p>
                    <img src="https://via.placeholder.com/300x200?text=æˆ‘ä»¬çš„${anniversary.days}å¤©" 
                         style="max-width: 100%; border-radius: 10px; margin: 1rem 0;">
                    <p>è¿™æ˜¯æˆ‘ä»¬çˆ±çš„ç¬¬ ${anniversary.days} å¤©</p>
                    <button onclick="this.parentNode.parentNode.remove()" style="
                        padding: 10px 20px;
                        background: var(--primary);
                        color: white;
                        border: none;
                        border-radius: 20px;
                        margin-top: 1rem;
                        cursor: pointer;
                    ">ç»§ç»­ä¹¦å†™æˆ‘ä»¬çš„æ•…äº‹</button>
                </div>
            `;
            
            document.body.appendChild(popup);
        }
        
        // æ˜¾ç¤ºæ›´æ–°æ—¥æœŸ
        function showUpdateDate() {
            document.getElementById('update-date').textContent = formatDate(new Date());
        }
        
        // æ ¼å¼åŒ–æ—¥æœŸ
        function formatDate(date) {
            return `${date.getFullYear()}å¹´${date.getMonth()+1}æœˆ${date.getDate()}æ—¥`;
        }
        
        // æ’­æ”¾/æš‚åœæˆ‘ä»¬çš„æ­Œï¼Œå¹¶æ”¯æŒåˆ‡æ¢ç½‘æ˜“äº‘éŸ³ä¹ID
        // ä¿æŒéŸ³é¢‘å¯¹è±¡å…¨å±€å”¯ä¸€ï¼Œé¿å…å¤šæ¬¡æ’­æ”¾é‡å 
        let ourSongAudio = null;
        function playOurSong() {
            if (!ourSongAudio) {
                ourSongAudio = new Audio(CONFIG.ourSong);
                ourSongAudio.loop = false; // å¦‚éœ€å¾ªç¯æ’­æ”¾å¯è®¾ä¸ºtrue
                // ç›‘å¬æ’­æ”¾å¤±è´¥
                ourSongAudio.onerror = function() {
                    alert('æ— æ³•æ’­æ”¾éŸ³ä¹ï¼Œå¯èƒ½è¯¥IDæ— ç‰ˆæƒæˆ–è¢«ä¸‹æ¶ï¼Œå°†æ¢å¤é»˜è®¤æ­Œæ›²');
                    // æ¢å¤é»˜è®¤æ­Œæ›²
                    CONFIG.ourSong = 'https://music.163.com/song/media/outer/url?id=568389828.mp3';
                    ourSongAudio = null;
                };
            }
            if (ourSongAudio.paused) {
                ourSongAudio.play().catch(e => alert('æ— æ³•è‡ªåŠ¨æ’­æ”¾ï¼Œè¯·ç‚¹å‡»é¡µé¢ä»»æ„å¤„åé‡è¯•'));
            } else {
                ourSongAudio.pause();
            }
        }
        // ç½‘æ˜“äº‘éŸ³ä¹IDåˆ‡æ¢åŠŸèƒ½ï¼ˆéœ€å¯†ç ï¼‰
        function searchAndPlaySong() {
            showPrompt('è¯·è¾“å…¥æ›´æ¢æ­Œæ›²çš„æƒé™å¯†ç ï¼š', function(pwd) {
                if (pwd !== 'zlyloveyzl') {
                    if (pwd !== null) showAlert('å¯†ç é”™è¯¯ï¼Œæ— æƒé™æ›´æ¢æ­Œæ›²ï¼');
                    return;
                }
                showPrompt('è¯·è¾“å…¥ç½‘æ˜“äº‘éŸ³ä¹çš„æ­Œæ›²IDï¼ˆæ•°å­—ï¼Œå¦‚568389828ï¼‰ï¼š', function(musicId) {
                    if (musicId && /^\d+$/.test(musicId)) {
                        const url = `https://music.163.com/song/media/outer/url?id=${musicId}.mp3`;
                        CONFIG.ourSong = url; // æ›´æ–°é…ç½®
                        if (ourSongAudio) {
                            ourSongAudio.pause();
                            ourSongAudio = null; // é‡Šæ”¾æ—§å¯¹è±¡
                        }
                        playOurSong(); // æ’­æ”¾æ–°æ­Œ
                    } else if (musicId) {
                        showAlert('è¯·è¾“å…¥æ­£ç¡®çš„ç½‘æ˜“äº‘éŸ³ä¹IDï¼ˆçº¯æ•°å­—ï¼‰');
                    }
                });
            });
        }
        // å¦‚éœ€å•ç‹¬æš‚åœæŒ‰é’®ï¼Œå¯è°ƒç”¨ playOurSong() æˆ–è‡ªå®šä¹‰
        
        // æ˜¾ç¤ºè®°å¿†æ·»åŠ æ¡†
        function showMemoryPrompt() {
            showPrompt('æ·»åŠ æ–°çš„ç¾å¥½å›å¿†:\n(æ ¼å¼: æ—¥æœŸ|æ ‡é¢˜|å†…å®¹)\nä¾‹å¦‚: 2025-08-01|ç¬¬ä¸€æ¬¡è§†é¢‘é€šè¯|èŠäº†æ•´æ•´ä¸‰å°æ—¶', function(memory) {
                if (memory) {
                    showAlert('å›å¿†å·²æ·»åŠ ! (å®é™…åŠŸèƒ½éœ€è¦åç«¯æ”¯æŒä¿å­˜)');
                }
            });
        }
        
        // æ˜¾ç¤ºçˆ±æƒ…è®¡ç®—å™¨
        function showLoveCalculator() {
            const lovePercent = Math.floor(Math.random() * 31) + 70; // 70-100%
            alert(`â¤ï¸ ä½ ä»¬çš„åŒ¹é…åº¦æ˜¯: ${lovePercent}% â¤ï¸\n\n${CONFIG.names.me} å’Œ ${CONFIG.names.you} æ˜¯å¤©é€ åœ°è®¾çš„ä¸€å¯¹ï¼`);
        }
        
        // åˆå§‹åŒ–
        window.onload = function() {
            initPage();
            createHearts();
            updateCurrentTime();
            updateTimeTogether();
            showUpdateDate();
            
            // æ¯ç§’æ›´æ–°æ—¶é—´
            setInterval(updateCurrentTime, 1000);
            setInterval(updateTimeTogether, 1000);
        };
    
    // æˆ’çƒŸæ‰“å¡åŠŸèƒ½ï¼ˆéšè—å…¥å£ï¼Œè¿ç»­ç‚¹å‡»ä¸»æ ‡é¢˜5æ¬¡å¼¹å‡ºï¼Œæ”¯æŒæœ¬åœ°å­˜å‚¨ï¼‰
    (function(){
        // å…¥å£è®¾ç½®ï¼šè¿ç»­ç‚¹å‡»ä¸»æ ‡é¢˜5æ¬¡è§¦å‘
        let clickCount = 0;
        let clickTimer = null;
        const title = document.getElementById('main-title');
        if (title) {
            title.addEventListener('click', function() {
                clickCount++;
                if (clickTimer) clearTimeout(clickTimer);
                // 2ç§’å†…è¿ç»­ç‚¹å‡»æ‰è®¡æ•°ï¼Œå¦åˆ™é‡ç½®
                clickTimer = setTimeout(()=>{clickCount=0;}, 2000);
                if (clickCount >= 5) {
                    clickCount = 0;
                    showQuitSmokingModal();
                }
            });
        }

        // æ‰“å¼€æˆ’çƒŸæ‰“å¡å¼¹çª—
        window.showQuitSmokingModal = function() {
            document.getElementById('quit-smoking-modal').style.display = 'flex';
            updateQuitSmokingUI();
        };
        // å…³é—­å¼¹çª—
        window.closeQuitSmokingModal = function() {
            document.getElementById('quit-smoking-modal').style.display = 'none';
        };

        // è·å–ä»Šå¤©æ—¥æœŸå­—ç¬¦ä¸²ï¼ˆyyyy-mm-ddï¼‰
        function getTodayStr() {
            const d = new Date();
            return d.getFullYear() + '-' + (d.getMonth()+1).toString().padStart(2,'0') + '-' + d.getDate().toString().padStart(2,'0');
        }
        // è·å–æ˜¨å¤©æ—¥æœŸå­—ç¬¦ä¸²
        function getYesterdayStr() {
            const d = new Date();
            d.setDate(d.getDate()-1);
            return d.getFullYear() + '-' + (d.getMonth()+1).toString().padStart(2,'0') + '-' + d.getDate().toString().padStart(2,'0');
        }
        // è·å–æœ¬åœ°å­˜å‚¨çš„æ‰“å¡æ•°æ®
        function getQSData() {
            let data = localStorage.getItem('quitSmokingData');
            if (!data) return {days:0, lastDate:'', history:[], streak:0, maxStreak:0, achievements:[]};
            try {
                let d = JSON.parse(data);
                if (!d.history) d.history = [];
                if (!d.achievements) d.achievements = [];
                if (!d.streak) d.streak = 0;
                if (!d.maxStreak) d.maxStreak = 0;
                return d;
            } catch { return {days:0, lastDate:'', history:[], streak:0, maxStreak:0, achievements:[]}; }
        }
        // ä¿å­˜æ‰“å¡æ•°æ®åˆ°æœ¬åœ°
        function setQSData(data) {
            localStorage.setItem('quitSmokingData', JSON.stringify(data));
        }
        // æ›´æ–°å¼¹çª—UIæ˜¾ç¤º
        function updateQuitSmokingUI() {
            const data = getQSData();
            document.getElementById('qs-days').textContent = `ç´¯è®¡æ‰“å¡ï¼š${data.days||0} å¤©`;
            document.getElementById('qs-streaks').textContent = `è¿ç»­ï¼š${data.streak||0} å¤©  |  æœ€é•¿è¿ç»­ï¼š${data.maxStreak||0} å¤©`;
            document.getElementById('qs-last-date').textContent = data.lastDate ? `ä¸Šæ¬¡æ‰“å¡ï¼š${data.lastDate}` : 'è¿˜æœªå¼€å§‹æ‰“å¡';
            const today = getTodayStr();
            const btn = document.getElementById('qs-punch-btn');
            if (data.history && data.history.includes(today)) {
                btn.disabled = true;
                btn.textContent = 'ä»Šæ—¥å·²æ‰“å¡';
                document.getElementById('qs-msg').textContent = getEncourageMsg(data.streak||0);
            } else {
                btn.disabled = false;
                btn.textContent = 'ä»Šæ—¥æ‰“å¡';
                document.getElementById('qs-msg').textContent = '';
            }
            // æ‰“å¡å†å²
            renderQSHistory(data.history||[]);
        }
        // é¼“åŠ±è¯­
        function getEncourageMsg(streak) {
            if (streak >= 30) return 'ä½ å·²ç»åšæŒ30å¤©ï¼Œè¶…æ£’ï¼ç»§ç»­ä¿æŒï¼';
            if (streak >= 14) return 'ä¸¤å‘¨ä¸æ˜“ï¼Œä¹ æƒ¯æ­£åœ¨å…»æˆï¼';
            if (streak >= 7) return 'ä¸€å‘¨æˆå°±è¾¾æˆï¼ç»§ç»­åŠ æ²¹ï¼';
            if (streak >= 3) return 'å·²ç»åšæŒ3å¤©ï¼Œè¿ˆå‡ºé‡è¦ä¸€æ­¥ï¼';
            if (streak > 0) return 'ç»§ç»­åŠ æ²¹ï¼æ¯ä¸€å¤©éƒ½å€¼å¾—éª„å‚²~';
            return '';
        }
        // æ‰“å¡å†å²æ¸²æŸ“
        function renderQSHistory(history) {
            const el = document.getElementById('qs-history');
            if (!history || history.length === 0) {
                el.innerHTML = '<span style="color:#bbb;">æš‚æ— æ‰“å¡è®°å½•</span>';
                return;
            }
            // å–æœ€è¿‘7å¤©
            let arr = [];
            let today = new Date();
            for (let i = 6; i >= 0; i--) {
                let d = new Date(today);
                d.setDate(d.getDate()-i);
                let ds = d.getFullYear()+'-'+(d.getMonth()+1).toString().padStart(2,'0')+'-'+d.getDate().toString().padStart(2,'0');
                arr.push(ds);
            }
            let html = '<b>æœ€è¿‘7å¤©ï¼š</b><br>';
            arr.forEach(date => {
                if (history.includes(date)) {
                    html += `<span style='color:#4caf50;'>âœ”ï¸${date}</span> `;
                } else {
                    html += `<span style='color:#bbb;'>âœ–ï¸${date}</span> `;
                }
            });
            el.innerHTML = html;
        }
        // ç‚¹å‡»"ä»Šæ—¥æ‰“å¡"æŒ‰é’®é€»è¾‘
        function punchQS() {
            let data = getQSData();
            const today = getTodayStr();
            const yesterday = getYesterdayStr();
            if (!data.history) data.history = [];
            if (!data.achievements) data.achievements = [];
            // è¿ç»­å¤©æ•°åˆ¤æ–­
            if (data.history.length > 0 && data.history[data.history.length-1] === yesterday) {
                data.streak = (data.streak||0) + 1;
            } else if (data.history.length > 0 && data.history[data.history.length-1] === today) {
                // å·²æ‰“å¡
            } else {
                data.streak = 1;
            }
            if (!data.history.includes(today)) {
                data.history.push(today);
                data.days = data.history.length;
                data.lastDate = today;
                if (!data.maxStreak || data.streak > data.maxStreak) data.maxStreak = data.streak;
                setQSData(data);
                checkQSAchievements(data);
            }
            updateQuitSmokingUI();
        }
        // æˆå°±æ£€æµ‹
        function checkQSAchievements(data) {
            const achs = [
                {streak:3, msg:'ğŸ‰ è¿ç»­æ‰“å¡3å¤©æˆå°±è¾¾æˆï¼ä¹ æƒ¯å…»æˆç¬¬ä¸€æ­¥ï¼'},
                {streak:7, msg:'ğŸ… è¿ç»­æ‰“å¡7å¤©æˆå°±è¾¾æˆï¼ä¸€å‘¨ä¸æ˜“ï¼Œç»§ç»­åŠ æ²¹ï¼'},
                {streak:14, msg:'ğŸ¥ˆ è¿ç»­æ‰“å¡14å¤©æˆå°±è¾¾æˆï¼ä½ å·²ç»å¾ˆæ£’äº†ï¼'},
                {streak:30, msg:'ğŸ† è¿ç»­æ‰“å¡30å¤©æˆå°±è¾¾æˆï¼ä½ å·²ç»æˆ˜èƒœäº†è‡ªå·±ï¼'}
            ];
            for (let i=0;i<achs.length;i++) {
                if (data.streak === achs[i].streak && !data.achievements.includes(achs[i].streak)) {
                    data.achievements.push(achs[i].streak);
                    setQSData(data);
                    setTimeout(()=>{
                        showQSAchievement(achs[i].msg);
                    }, 300);
                }
            }
        }
        // æˆå°±å¼¹çª—
        function showQSAchievement(msg) {
            const div = document.createElement('div');
            div.style.position = 'fixed';
            div.style.top = '30%';
            div.style.left = '50%';
            div.style.transform = 'translate(-50%,-50%)';
            div.style.background = '#fff6fa';
            div.style.color = '#ff6b9e';
            div.style.padding = '1.2rem 2rem';
            div.style.borderRadius = '18px';
            div.style.fontSize = '1.2rem';
            div.style.boxShadow = '0 8px 32px #0003';
            div.style.zIndex = 100001;
            div.textContent = msg;
            document.body.appendChild(div);
            setTimeout(()=>{div.remove();}, 2600);
        }
        // é‡ç½®æ‰“å¡
        function resetQS() {
            if (confirm('ç¡®å®šè¦é‡ç½®æ‰€æœ‰æ‰“å¡æ•°æ®å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ã€‚')) {
                localStorage.removeItem('quitSmokingData');
                updateQuitSmokingUI();
            }
        }
        // ç»‘å®šæŒ‰é’®äº‹ä»¶
        document.getElementById('qs-punch-btn').onclick = punchQS;
        document.getElementById('qs-reset-btn').onclick = resetQS;
    })();
    </script>
</body>
    </div>
    <!-- éšç§é®ç½©å·²ç§»é™¤ï¼Œé¡µé¢å†…å®¹æ¢å¤å¯è§ -->
    </html>